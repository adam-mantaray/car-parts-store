<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pricing | AutoParts Admin</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="stylesheet" href="../css/style.css?v=2">
  <script>tailwind.config={theme:{extend:{colors:{dark:{50:'#e8e8ef',100:'#b0b0c0',200:'#8888a0',300:'#5a5a72',400:'#3a3a4a',500:'#2a2a3a',600:'#1e1e2a',700:'#16161f',800:'#111118',900:'#0a0a0f'},accent:{DEFAULT:'#3b82f6',light:'#60a5fa',dark:'#1d4ed8'}},fontFamily:{sans:['Inter','sans-serif'],cairo:['Cairo','sans-serif']}}}}</script>
</head>
<body class="bg-dark-900 text-dark-50">
  <div class="flex min-h-screen">
    <aside class="w-64 bg-dark-800 border-r border-dark-500 flex-shrink-0 hidden lg:flex flex-col">
      <div class="p-6 border-b border-dark-500">
        <a href="../index.html" class="flex items-center gap-3">
          <div class="w-9 h-9 rounded-lg bg-gradient-to-br from-accent to-accent-dark flex items-center justify-center"><i class="fa-solid fa-gear text-white"></i></div>
          <div><div class="font-bold text-sm">AutoParts EG</div><div class="text-[10px] text-dark-400 uppercase tracking-wider">Admin Panel</div></div>
        </a>
      </div>
      <nav class="flex-1 p-4 space-y-1">
        <a href="index.html" class="flex items-center gap-3 px-4 py-2.5 rounded-lg text-dark-300 hover:bg-dark-700 hover:text-dark-50 transition-colors text-sm"><i class="fa-solid fa-chart-line w-5"></i> Dashboard</a>
        <a href="parts.html" class="flex items-center gap-3 px-4 py-2.5 rounded-lg text-dark-300 hover:bg-dark-700 hover:text-dark-50 transition-colors text-sm"><i class="fa-solid fa-boxes-stacked w-5"></i> Parts</a>
        <a href="pricing.html" class="flex items-center gap-3 px-4 py-2.5 rounded-lg bg-accent/10 text-accent-light text-sm font-medium"><i class="fa-solid fa-coins w-5"></i> Pricing</a>
        <a href="orders.html" class="flex items-center gap-3 px-4 py-2.5 rounded-lg text-dark-300 hover:bg-dark-700 hover:text-dark-50 transition-colors text-sm"><i class="fa-solid fa-receipt w-5"></i> Orders</a>
      </nav>
      <div class="p-4 border-t border-dark-500"><a href="../index.html" class="flex items-center gap-3 px-4 py-2 text-sm text-dark-400 hover:text-dark-200 transition-colors"><i class="fa-solid fa-arrow-left w-5"></i> Back to Store</a></div>
    </aside>

    <main class="flex-1 overflow-auto">
      <header class="h-16 border-b border-dark-500 flex items-center px-8 bg-dark-800/50">
        <h1 class="text-lg font-bold">Pricing Engine</h1>
      </header>

      <div class="p-8">
        <!-- Formula -->
        <div class="card p-8 mb-8">
          <h2 class="text-xl font-bold mb-6 flex items-center gap-3">
            <i class="fa-solid fa-calculator text-accent"></i>
            Pricing Formula
          </h2>
          <div class="bg-dark-900 rounded-xl p-6 border border-dark-500 mb-6">
            <div class="font-mono text-center">
              <span class="text-2xl font-bold">EGP</span>
              <span class="text-dark-400 text-2xl mx-3">=</span>
              <span class="text-2xl font-bold text-accent-light">USD</span>
              <span class="text-dark-400 text-2xl mx-3">&times;</span>
              <span class="text-2xl font-bold text-yellow-400">max</span>
              <span class="text-dark-400 text-xl">(</span>
              <span class="text-2xl font-bold text-green-400">50</span>
              <span class="text-dark-400 text-xl">,</span>
              <span class="text-2xl font-bold text-purple-400 ml-2">market_rate</span>
              <span class="text-dark-400 text-xl">)</span>
            </div>
          </div>

          <div class="grid md:grid-cols-3 gap-6">
            <div>
              <label class="block text-xs uppercase tracking-wider text-dark-300 mb-2 font-semibold">Minimum Rate (Floor)</label>
              <input type="number" id="floorRate" value="50" class="w-full bg-dark-700 border border-dark-500 rounded-lg px-4 py-3 text-dark-50 text-xl font-bold focus:border-accent focus:outline-none">
              <p class="text-xs text-dark-400 mt-2">Never convert below this rate</p>
            </div>
            <div>
              <label class="block text-xs uppercase tracking-wider text-dark-300 mb-2 font-semibold">Current Market Rate</label>
              <input type="number" id="marketRate" value="49.85" class="w-full bg-dark-700 border border-dark-500 rounded-lg px-4 py-3 text-dark-50 text-xl font-bold focus:border-accent focus:outline-none">
              <p class="text-xs text-dark-400 mt-2">Live USD/EGP rate</p>
            </div>
            <div>
              <label class="block text-xs uppercase tracking-wider text-dark-300 mb-2 font-semibold">Effective Rate</label>
              <div class="w-full bg-dark-600 border border-accent/30 rounded-lg px-4 py-3 text-accent-light text-xl font-bold" id="effectiveRate">50</div>
              <p class="text-xs text-dark-400 mt-2">Rate used for all calculations</p>
            </div>
          </div>
        </div>

        <!-- Price Simulator -->
        <div class="card p-8 mb-8">
          <h3 class="font-bold mb-6 flex items-center gap-3">
            <i class="fa-solid fa-flask text-accent"></i>
            Price Simulator
          </h3>
          <div class="grid md:grid-cols-2 gap-8">
            <div>
              <label class="block text-xs uppercase tracking-wider text-dark-300 mb-2 font-semibold">Part USD Price</label>
              <input type="number" id="simUsd" value="322.78" step="0.01" class="w-full bg-dark-700 border border-dark-500 rounded-lg px-4 py-3 text-dark-50 focus:border-accent focus:outline-none">
              <p class="text-xs text-dark-400 mt-2">Example: Front Fender A2058800118</p>
            </div>
            <div>
              <label class="block text-xs uppercase tracking-wider text-dark-300 mb-2 font-semibold">Result (EGP)</label>
              <div class="w-full bg-dark-600 border border-green-500/30 rounded-lg px-4 py-3 text-green-400 text-2xl font-bold" id="simResult">16,139 EGP</div>
              <p class="text-xs text-dark-400 mt-2" id="simFormula">$322.78 x 50 = 16,139 EGP</p>
            </div>
          </div>
        </div>

        <!-- Top 10 most expensive -->
        <div class="card overflow-hidden">
          <div class="p-6 border-b border-dark-500">
            <h3 class="font-bold text-sm flex items-center gap-2"><i class="fa-solid fa-arrow-up-wide-short text-accent"></i> Top 10 Most Expensive Parts</h3>
          </div>
          <table class="data-table">
            <thead><tr><th>#</th><th>OEM</th><th>Part</th><th>USD</th><th>EGP</th></tr></thead>
            <tbody id="topParts"></tbody>
          </table>
        </div>
      </div>
    </main>
  </div>

  <script src="../js/app.js?v=2"></script>
  <script>
    function updatePricing() {
      const floor = parseFloat(document.getElementById('floorRate').value) || 50;
      const market = parseFloat(document.getElementById('marketRate').value) || 49.85;
      const effective = Math.max(floor, market);
      document.getElementById('effectiveRate').textContent = effective;

      const usd = parseFloat(document.getElementById('simUsd').value) || 0;
      const egp = Math.round(usd * effective);
      document.getElementById('simResult').textContent = fmtEGP(egp);
      document.getElementById('simFormula').textContent = `$${usd.toFixed(2)} x ${effective} = ${fmtEGP(egp)}`;
    }

    document.getElementById('floorRate').addEventListener('input', updatePricing);
    document.getElementById('marketRate').addEventListener('input', updatePricing);
    document.getElementById('simUsd').addEventListener('input', updatePricing);
    updatePricing();

    // Top 10
    const top = [...PARTS].sort((a,b) => b.priceEgp - a.priceEgp).slice(0, 10);
    document.getElementById('topParts').innerHTML = top.map((p, i) => `
      <tr>
        <td class="text-dark-400">${i + 1}</td>
        <td><span class="oem-badge">${p.oem}</span></td>
        <td>${p.nameEn}</td>
        <td class="text-dark-300">${fmtUSD(p.priceUsd)}</td>
        <td class="font-bold">${fmtEGP(p.priceEgp)}</td>
      </tr>
    `).join('');
  </script>
</body>
</html>
