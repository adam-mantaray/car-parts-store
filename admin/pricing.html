<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>التسعير - AutoParts EG</title>
  <link rel="stylesheet" href="../css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: { extend: {
        colors: { dark: { 1: '#1c1c1e', 2: '#2a2a2e', 3: '#333338' }, gold: { DEFAULT: '#c9a96e', light: '#d4b97e', dark: '#b8944f' }, muted: '#9a9a9e' },
        fontFamily: { cairo: ['Cairo'], inter: ['Inter'], mono: ['JetBrains Mono'] }
      }}
    }
  </script>
</head>
<body class="bg-dark-1">
  <aside class="admin-sidebar">
    <div class="px-6 mb-8">
      <a href="../index.html" class="flex items-center gap-2">
        <i class="fa-solid fa-gear text-gold text-xl"></i>
        <span class="font-cairo text-lg font-bold">AutoParts <span class="text-gold">EG</span></span>
      </a>
    </div>
    <a href="index.html"><i class="fa-solid fa-chart-line"></i><span class="font-cairo">لوحة التحكم</span></a>
    <a href="parts.html"><i class="fa-solid fa-boxes-stacked"></i><span class="font-cairo">القطع</span></a>
    <a href="pricing.html" class="active"><i class="fa-solid fa-coins"></i><span class="font-cairo">التسعير</span></a>
    <a href="orders.html"><i class="fa-solid fa-clipboard-list"></i><span class="font-cairo">الطلبات</span></a>
  </aside>

  <div class="admin-content">
    <h1 class="font-cairo text-3xl font-bold mb-8">التسعير وسعر الصرف</h1>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-10">
      <!-- Current Rate -->
      <div class="bg-dark-2 rounded-xl p-8 border border-dark-3 text-center">
        <p class="text-muted font-cairo mb-2">سعر الصرف الحالي</p>
        <div class="font-cairo text-6xl font-black text-gold mb-2" id="currentRate">50</div>
        <p class="font-inter text-muted text-sm">EGP per 1 USD</p>
      </div>
      <!-- Formula -->
      <div class="bg-dark-2 rounded-xl p-8 border border-dark-3">
        <h3 class="font-cairo text-xl font-bold mb-4"><i class="fa-solid fa-calculator text-gold ml-2"></i>معادلة التسعير</h3>
        <div class="bg-dark-1 rounded-lg p-4 font-mono text-gold text-lg text-center mb-4">
          EGP = USD x max(50, سعر الصرف)
        </div>
        <p class="text-muted font-cairo text-sm">الحد الادنى لسعر الصرف 50 جنيه حتى لو السعر الرسمي اقل</p>
      </div>
    </div>

    <!-- Rate Input -->
    <div class="bg-dark-2 rounded-xl p-8 border border-dark-3 mb-10">
      <h3 class="font-cairo text-xl font-bold mb-6">تحديث سعر الصرف</h3>
      <div class="flex items-end gap-4 max-w-md">
        <div class="flex-1">
          <label class="font-cairo text-sm text-muted block mb-2">سعر الصرف الجديد</label>
          <input type="number" id="newRate" value="50" class="input-dark font-mono text-2xl text-gold text-center" step="0.5">
        </div>
        <button onclick="updateRate()" class="btn-gold py-3 px-8">تحديث</button>
      </div>
    </div>

    <!-- Preview Table -->
    <div class="bg-dark-2 rounded-xl p-8 border border-dark-3 mb-10">
      <h3 class="font-cairo text-xl font-bold mb-6">معاينة الاسعار (اول 10 قطع)</h3>
      <table class="table-dark">
        <thead><tr><th>القطعة</th><th>USD</th><th>EGP (حالي)</th><th>EGP (جديد)</th></tr></thead>
        <tbody id="previewTable"></tbody>
      </table>
    </div>

    <!-- Historical -->
    <div class="bg-dark-2 rounded-xl p-8 border border-dark-3">
      <h3 class="font-cairo text-xl font-bold mb-6">سجل الاسعار</h3>
      <table class="table-dark">
        <thead><tr><th>التاريخ</th><th>السعر</th><th>التغيير</th></tr></thead>
        <tbody>
          <tr><td class="font-inter text-sm">2024-01-15</td><td class="font-mono text-gold">50.00</td><td class="text-muted">--</td></tr>
          <tr><td class="font-inter text-sm">2024-01-01</td><td class="font-mono text-gold">49.50</td><td class="badge badge-success">+1.01%</td></tr>
          <tr><td class="font-inter text-sm">2023-12-15</td><td class="font-mono text-gold">48.00</td><td class="badge badge-success">+3.13%</td></tr>
          <tr><td class="font-inter text-sm">2023-12-01</td><td class="font-mono text-gold">47.00</td><td class="badge badge-success">+2.13%</td></tr>
          <tr><td class="font-inter text-sm">2023-11-15</td><td class="font-mono text-gold">45.00</td><td class="badge badge-success">+4.44%</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <script src="../js/app.js"></script>
  <script>
    function renderPreview() {
      const newRate = Math.max(50, parseFloat(document.getElementById('newRate').value) || 50);
      document.getElementById('previewTable').innerHTML = PARTS.slice(0, 10).map(p => {
        const newEgp = Math.round(p.priceUsd * newRate);
        const diff = newEgp - p.priceEgp;
        return `<tr>
          <td class="font-cairo text-sm">${p.nameAr}</td>
          <td class="font-inter text-sm">${fmtUSD(p.priceUsd)}</td>
          <td class="price-gold text-base">${fmtEGP(p.priceEgp)}</td>
          <td class="font-cairo font-bold ${diff > 0 ? 'text-red-400' : diff < 0 ? 'text-green-400' : 'text-gold'}">${fmtEGP(newEgp)}</td>
        </tr>`;
      }).join('');
    }
    document.getElementById('newRate').addEventListener('input', renderPreview);
    renderPreview();

    function updateRate() {
      const rate = parseFloat(document.getElementById('newRate').value) || 50;
      document.getElementById('currentRate').textContent = Math.max(50, rate);
      showToast('تم تحديث سعر الصرف');
    }
  </script>
</body>
</html>
