<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Parts Management | AutoParts Admin</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="stylesheet" href="../css/style.css?v=2">
  <script>tailwind.config={theme:{extend:{colors:{dark:{50:'#e8e8ef',100:'#b0b0c0',200:'#8888a0',300:'#5a5a72',400:'#3a3a4a',500:'#2a2a3a',600:'#1e1e2a',700:'#16161f',800:'#111118',900:'#0a0a0f'},accent:{DEFAULT:'#3b82f6',light:'#60a5fa',dark:'#1d4ed8'}},fontFamily:{sans:['Inter','sans-serif'],cairo:['Cairo','sans-serif']}}}}</script>
</head>
<body class="bg-dark-900 text-dark-50">
  <div class="flex min-h-screen">
    <aside class="w-64 bg-dark-800 border-r border-dark-500 flex-shrink-0 hidden lg:flex flex-col">
      <div class="p-6 border-b border-dark-500">
        <a href="../index.html" class="flex items-center gap-3">
          <div class="w-9 h-9 rounded-lg bg-gradient-to-br from-accent to-accent-dark flex items-center justify-center"><i class="fa-solid fa-gear text-white"></i></div>
          <div><div class="font-bold text-sm">AutoParts EG</div><div class="text-[10px] text-dark-400 uppercase tracking-wider">Admin Panel</div></div>
        </a>
      </div>
      <nav class="flex-1 p-4 space-y-1">
        <a href="index.html" class="flex items-center gap-3 px-4 py-2.5 rounded-lg text-dark-300 hover:bg-dark-700 hover:text-dark-50 transition-colors text-sm"><i class="fa-solid fa-chart-line w-5"></i> Dashboard</a>
        <a href="parts.html" class="flex items-center gap-3 px-4 py-2.5 rounded-lg bg-accent/10 text-accent-light text-sm font-medium"><i class="fa-solid fa-boxes-stacked w-5"></i> Parts</a>
        <a href="pricing.html" class="flex items-center gap-3 px-4 py-2.5 rounded-lg text-dark-300 hover:bg-dark-700 hover:text-dark-50 transition-colors text-sm"><i class="fa-solid fa-coins w-5"></i> Pricing</a>
        <a href="orders.html" class="flex items-center gap-3 px-4 py-2.5 rounded-lg text-dark-300 hover:bg-dark-700 hover:text-dark-50 transition-colors text-sm"><i class="fa-solid fa-receipt w-5"></i> Orders</a>
      </nav>
      <div class="p-4 border-t border-dark-500"><a href="../index.html" class="flex items-center gap-3 px-4 py-2 text-sm text-dark-400 hover:text-dark-200 transition-colors"><i class="fa-solid fa-arrow-left w-5"></i> Back to Store</a></div>
    </aside>

    <main class="flex-1 overflow-auto">
      <header class="h-16 border-b border-dark-500 flex items-center justify-between px-8 bg-dark-800/50">
        <h1 class="text-lg font-bold">Parts Management</h1>
        <div class="flex items-center gap-3">
          <input type="text" id="adminSearch" placeholder="Search parts..." class="bg-dark-700 border border-dark-500 rounded-lg px-4 py-2 text-sm text-dark-50 placeholder-dark-400 focus:border-accent focus:outline-none w-64">
          <select id="adminCatFilter" class="bg-dark-700 border border-dark-500 rounded-lg px-3 py-2 text-sm text-dark-50 focus:border-accent focus:outline-none">
            <option value="all">All Categories</option>
          </select>
        </div>
      </header>

      <div class="p-8">
        <!-- Summary -->
        <div class="grid grid-cols-3 gap-4 mb-6">
          <div class="stat-card flex items-center gap-4">
            <div class="w-10 h-10 rounded-lg bg-blue-500/10 flex items-center justify-center"><i class="fa-solid fa-boxes-stacked text-blue-400"></i></div>
            <div><div class="text-xl font-bold" id="partCount">0</div><div class="text-xs text-dark-400">Total Parts</div></div>
          </div>
          <div class="stat-card flex items-center gap-4">
            <div class="w-10 h-10 rounded-lg bg-green-500/10 flex items-center justify-center"><i class="fa-solid fa-check text-green-400"></i></div>
            <div><div class="text-xl font-bold text-green-400" id="inStockCount">0</div><div class="text-xs text-dark-400">In Stock</div></div>
          </div>
          <div class="stat-card flex items-center gap-4">
            <div class="w-10 h-10 rounded-lg bg-yellow-500/10 flex items-center justify-center"><i class="fa-solid fa-database text-yellow-400"></i></div>
            <div><div class="text-xl font-bold text-yellow-400" id="epcCount">0</div><div class="text-xs text-dark-400">EPC Verified</div></div>
          </div>
        </div>

        <!-- Table -->
        <div class="card overflow-hidden">
          <div class="overflow-x-auto">
            <table class="data-table">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>OEM Number</th>
                  <th>Part Name (EN)</th>
                  <th>Part Name (AR)</th>
                  <th>Category</th>
                  <th>USD</th>
                  <th>EGP</th>
                  <th>Stock</th>
                  <th>Source</th>
                </tr>
              </thead>
              <tbody id="partsTableBody"></tbody>
            </table>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script src="../js/app.js?v=2"></script>
  <script>
    const catFilter = document.getElementById('adminCatFilter');
    CATEGORIES.forEach(c => { catFilter.innerHTML += `<option value="${c.id}">${c.nameEn}</option>`; });

    function renderAdmin() {
      const search = document.getElementById('adminSearch').value.toLowerCase();
      const cat = catFilter.value;
      let parts = [...PARTS];
      if (cat !== 'all') parts = parts.filter(p => p.category === cat);
      if (search) parts = parts.filter(p => p.oem.toLowerCase().includes(search) || p.nameEn.toLowerCase().includes(search) || p.nameAr.includes(search));

      document.getElementById('partCount').textContent = parts.length;
      document.getElementById('inStockCount').textContent = parts.filter(p => p.inStock).length;
      document.getElementById('epcCount').textContent = parts.filter(p => p.scraped).length;

      document.getElementById('partsTableBody').innerHTML = parts.map(p => {
        const c = CATEGORIES.find(x => x.id === p.category);
        return `<tr>
          <td class="text-dark-400 text-xs">${p.id}</td>
          <td><span class="oem-badge">${p.oem}</span></td>
          <td class="text-sm">${p.nameEn}</td>
          <td class="font-cairo text-sm text-dark-300">${p.nameAr}</td>
          <td class="text-xs text-dark-300">${c ? c.nameEn : ''}</td>
          <td class="text-dark-300">${fmtUSD(p.priceUsd)}</td>
          <td class="font-semibold">${fmtEGP(p.priceEgp)}</td>
          <td><span class="stock-dot ${p.inStock ? 'in-stock' : 'out-of-stock'}"></span></td>
          <td>${p.scraped ? '<span class="text-green-400 text-xs"><i class="fa-solid fa-check-circle"></i></span>' : '<span class="text-dark-500 text-xs"><i class="fa-solid fa-minus"></i></span>'}</td>
        </tr>`;
      }).join('');
    }

    document.getElementById('adminSearch').addEventListener('input', renderAdmin);
    catFilter.addEventListener('change', renderAdmin);
    renderAdmin();
  </script>
</body>
</html>
